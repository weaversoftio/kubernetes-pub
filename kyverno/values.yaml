# Kyverno Helm Values
# Enables Convention over Configuration (CoC) features

# Admission Controller - handles validate, mutate, and generate rules
admissionController:
  replicas: 1
  nodeSelector:
    dedicated: tools
  tolerations:
    - key: "dedicated"
      operator: "Equal"
      value: "tools"
      effect: "NoSchedule"
  
  # Enable webhooks for different rule types
  webhooks:
    # Resource webhook - handles generate and mutate-existing rules
    resource:
      enabled: true
    
    # Policy webhook - validates policies
    policy:
      enabled: true

# Background Controller - processes existing resources
backgroundController:
  replicas: 1
  nodeSelector:
    dedicated: tools
  tolerations:
    - key: "dedicated"
      operator: "Equal"
      value: "tools"
      effect: "NoSchedule"
  
# Cleanup Controller - handles cleanup policies
cleanupController:
  replicas: 1
  nodeSelector:
    dedicated: tools
  tolerations:
    - key: "dedicated"
      operator: "Equal"
      value: "tools"
      effect: "NoSchedule"

# Reports Controller - generates policy reports  
reportsController:
  replicas: 1
  nodeSelector:
    dedicated: tools
  tolerations:
    - key: "dedicated"
      operator: "Equal"
      value: "tools"
      effect: "NoSchedule"

# Features configuration
features:
  # Enable generate rules (required for auto-creating HTTPRoutes)
  generateValidatingAdmissionPolicy:
    enabled: false  # We use regular webhooks
  
  # Enable policy exceptions
  policyExceptions:
    enabled: true
    
  # Enable background scanning
  backgroundScan:
    enabled: true
    backgroundScanInterval: "1h"

# Webhook configuration
webhooksCleanup:
  enabled: true

# Generate self-signed TLS certificates for webhooks
generatecontrollerExtraResources: []
initContainer:
  generateCerts: true

webhook:
  generateSelfSignedCert: true

